<div class="d-flex align-items-center">
    <h2 class="m-4 flex-grow-1">Uživatelé</h2>
    <button class="btn btn-secondary m-1">Exportovat</button>
    <button class="btn btn-secondary m-1 mr-4">Importovat</button>
</div>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th class="sticky-top bg-white">Id</th>
            <th class="table-column-fill sticky-top bg-white">Uživatelské jméno</th>
            <th class="table-column-fill sticky-top bg-white">Heslo</th>
            <th class="table-column-fill sticky-top bg-white">Jméno</th>
            <th class="table-column-fill sticky-top bg-white">Příjmení</th>
            <th class="table-column-fill sticky-top bg-white">Email</th>
            <th class="sticky-top bg-white">Knihovník</th>
            <th class="sticky-top bg-white">Administrátor</th>
            <th class="pr-0 sticky-top bg-white">
                <button [class.invisible]="!canSaveAll" [disabled]="!isAllValid" class="btn btn-sm btn-success"
                    (click)="saveAll()">Uložit</button>
            </th>
            <th class="sticky-top bg-white">
                <button [class.invisible]="!canDiscardAll" class="btn btn-sm btn-danger"
                    (click)="discardAll()">Zahodit</button>
            </th>
            <th class="sticky-top bg-white"></th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let user of users"
            [class.table-warning]="(user.isChanged || user.original === null) && user !== newUser">
            <td>{{user.original !== null ? user.original.id : ""}}</td>
            <td class="table-column-fill">
                <input [class.is-invalid]="!user.isUserNameValid && user !== newUser"
                    class="form-control form-control-sm editable-cell" placeholder="Nevyplněno" type="text"
                    [(ngModel)]="user.newUserName">
            </td>
            <td class="table-column-fill">
                <input [class.is-invalid]="!user.isPasswordValid && user !== newUser"
                    class="form-control form-control-sm editable-cell"
                    [placeholder]="user.original === null ? 'Nevyplněno' : 'Nezměněno'" type="password"
                    [(ngModel)]="user.newPassword">
            </td>
            <td class="table-column-fill">
                <input class="form-control form-control-sm editable-cell" placeholder="Nevyplněno" type="text"
                    [(ngModel)]="user.newFirstName">
            </td>
            <td class="table-column-fill">
                <input class="form-control form-control-sm editable-cell" placeholder="Nevyplněno" type="text"
                    [(ngModel)]="user.newLastName">
            </td>
            <td class="table-column-fill">
                <input [class.is-invalid]="!user.isEmailValid && user !== newUser"
                    class="form-control form-control-sm editable-cell" placeholder="Nevyplněno" type="text"
                    [(ngModel)]="user.newEmail">
            </td>
            <td>
                <div class="form-check text-center">
                    <input style="width: 18px; height: 19px; cursor: pointer;" class="form-check-input position-static"
                        type="checkbox" [(ngModel)]="user.newIsLibrarian">
                </div>
            </td>
            <td>
                <div class="form-check text-center">
                    <input style="width: 18px; height: 19px; cursor: pointer;" class="form-check-input position-static"
                        type="checkbox" [(ngModel)]="user.newIsAdministrator">
                </div>
            </td>
            <td class="pr-0">
                <button [class.invisible]="!user.isChanged && user.original !== null || user === newUser"
                    [disabled]="!user.isValid" class="btn btn-sm btn-success" (click)="save(user)">Uložit</button>
            </td>
            <td>
                <button [class.invisible]="!user.isChanged && user.original !== null || user === newUser"
                    class="btn btn-sm btn-danger" (click)="discard(user)">Zahodit</button>
            </td>
            <td>
                <i *ngIf="user.original !== null" class="fas fa-trash fa-2x cursor-pointer text-muted"
                    style="font-size: 1.5em" (click)="remove(user)"></i>
            </td>
        </tr>
    </tbody>
</table>